# GitLab æäº¤è®°å½•è·å–è„šæœ¬

> **è¯´æ˜**ï¼šæœ¬è„šæœ¬ä»…æ”¯æŒ GitLabï¼Œå¦‚éœ€ GitHub è¯·ä½¿ç”¨ `fetch_commits_github.py`

## ğŸ“‹ åŠŸèƒ½è¯´æ˜

è¿™ä¸ªè„šæœ¬å¯ä»¥å®Œæ•´åœ°è·å–ä½ åœ¨ GitLab ä¸Šçš„æ‰€æœ‰æäº¤è®°å½•ï¼ŒåŒ…æ‹¬ï¼š
- âœ… è·å–ç”¨æˆ·çš„æ‰€æœ‰é¡¹ç›®ï¼ˆåŒ…æ‹¬ä½œä¸ºæˆå‘˜å‚ä¸çš„é¡¹ç›®ï¼‰
- âœ… éå†æ¯ä¸ªé¡¹ç›®çš„æ‰€æœ‰åˆ†æ”¯
- âœ… è·å–æŒ‡å®šæ—¶é—´èŒƒå›´å†…çš„æäº¤è®°å½•
- âœ… è‡ªåŠ¨å»é‡ï¼ˆåŒä¸€ä¸ª commit å¯èƒ½åœ¨å¤šä¸ªåˆ†æ”¯ä¸Šï¼‰
- âœ… æŒ‰æ—¶é—´æ’åº
- âœ… ä¿å­˜ä¸º JSON å’Œ TXT ä¸¤ç§æ ¼å¼
- âœ… ç”Ÿæˆç»Ÿè®¡æ‘˜è¦

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1ï¸âƒ£ ç”Ÿæˆ GitLab Token

1. ç™»å½• GitLab
2. å³ä¸Šè§’å¤´åƒ -> **Settings** -> **Access Tokens**
3. ç‚¹å‡» **Add new token**
4. å¡«å†™ï¼š
   - Token name: `commits-fetcher`
   - Expiration date: é€‰æ‹©è¿‡æœŸæ—¶é—´
   - Select scopes: å‹¾é€‰ `api` å’Œ `read_repository`
5. ç‚¹å‡» **Create personal access token**
6. **ç«‹å³å¤åˆ¶ç”Ÿæˆçš„ Token**ï¼ˆåªæ˜¾ç¤ºä¸€æ¬¡ï¼ï¼‰

### 2ï¸âƒ£ é…ç½®è„šæœ¬

å¤åˆ¶ç¤ºä¾‹é…ç½®æ–‡ä»¶å¹¶ä¿®æ”¹ï¼š

```bash
cd src
cp config.example.json config.json
```

ç¼–è¾‘ `config.json`ï¼Œå¡«å…¥ä½ çš„ä¿¡æ¯ï¼š

```json
{
  "gitlab_url": "http://192.168.1.231",
  "private_token": "glpat-è¿™é‡Œç²˜è´´ä½ çš„token",
  "since_date": "2026-01-19T00:00:00Z",
  "until_date": null,
  "output_file": "commits_2026-01-19_to_25.json",
  "include_branches": true
}
```

**é…ç½®è¯´æ˜**ï¼š

| å­—æ®µ | è¯´æ˜ | ç¤ºä¾‹ | å¿…å¡« |
|------|------|------|------|
| `gitlab_url` | GitLab æœåŠ¡å™¨åœ°å€ | `http://192.168.1.231` | âœ… |
| `private_token` | ä½ çš„è®¿é—®ä»¤ç‰Œ | `glpat-xxxxxxxxxxxxxx` | âœ… |
| `since_date` | èµ·å§‹æ—¶é—´ï¼ˆISO 8601ï¼‰ | `2026-01-19T00:00:00Z` | âŒ |
| `until_date` | ç»“æŸæ—¶é—´ï¼Œ`null` = ç°åœ¨ | `null` æˆ– `2026-01-25T23:59:59Z` | âŒ |
| `output_file` | è¾“å‡ºæ–‡ä»¶å | `commits_2026-01.json` | âŒ |
| `include_branches` | æ˜¯å¦éå†æ‰€æœ‰åˆ†æ”¯ | `true` æˆ– `false` | âŒ |

### 3ï¸âƒ£ å®‰è£…ä¾èµ–

```bash
pip install requests
```

### 4ï¸âƒ£ è¿è¡Œè„šæœ¬

```bash
python fetch_commits_gitlab.py
```

## ğŸ“ è¾“å‡ºæ–‡ä»¶

è„šæœ¬ä¼šç”Ÿæˆä¸‰ä¸ªæ–‡ä»¶ï¼š

### 1. JSON æ–‡ä»¶ï¼ˆ`commits_*.json`ï¼‰
ç»“æ„åŒ–æ•°æ®ï¼Œä¾¿äºç¨‹åºå¤„ç†

### 2. TXT æ–‡ä»¶ï¼ˆ`commits_*.txt`ï¼‰
ä¾¿äºé˜…è¯»çš„æ–‡æœ¬æ ¼å¼

### 3. Markdown æ–‡ä»¶ï¼ˆ`commits_*.md`ï¼‰â­ æ¨èç»™AIåˆ†æ
- âœ… Token æ•ˆç‡é«˜ï¼ˆç»“æ„ç®€æ´ï¼‰
- âœ… AI ç†è§£å‹å¥½ï¼ˆå¤§æ¨¡å‹å¯¹ Markdown å¤„ç†æœ€å¥½ï¼‰
- âœ… ä¾¿äºè½¬æ¢ä¸ºå·¥ä½œæ—¥å¿—
- âœ… äººç±»ä¹Ÿå¯è¯»

**ç¤ºä¾‹æ ¼å¼**ï¼š
```markdown
# GitLab æäº¤è®°å½•

## ğŸ“Š å…ƒæ•°æ®
- **è·å–æ—¶é—´**: 2026-01-30 16:30:00
- **æäº¤æ•°é‡**: 77

## ğŸ“… 2026-01-23

### 09:03 - feat: å®ç°TD-004è®¾å¤‡ç¼“å­˜Redisè‡ªåŠ¨åˆ·æ–°æœºåˆ¶
- **é¡¹ç›®**: wangxiaozhuang/alarm-project
- **åˆ†æ”¯**: feature/alarm_project
- **æäº¤**: `abc1234`
- **ä½œè€…**: ç‹å°å£®
```

## ğŸ“Š ç»Ÿè®¡æ‘˜è¦

è¿è¡Œå®Œæˆåä¼šæ˜¾ç¤ºæäº¤ç»Ÿè®¡ï¼šæ€»æäº¤æ•°ã€æŒ‰é¡¹ç›®ç»Ÿè®¡ã€æŒ‰ä½œè€…ç»Ÿè®¡ã€æŒ‰æ—¥æœŸç»Ÿè®¡

## ğŸ¯ ä½¿ç”¨åœºæ™¯

### è·å–æœ¬å‘¨çš„æäº¤è®°å½•
ä¿®æ”¹ `config.json`:
```json
{
  "since_date": "2026-01-27T00:00:00Z",
  "until_date": null,
  "output_file": "commits_this_week.json"
}
```

### è·å–æŸä¸ªæ—¶é—´æ®µçš„æäº¤
```json
{
  "since_date": "2026-01-01T00:00:00Z",
  "until_date": "2026-01-31T23:59:59Z",
  "output_file": "commits_2026-01.json"
}
```

### åªè·å–é»˜è®¤åˆ†æ”¯ï¼ˆæ›´å¿«ï¼‰
```json
{
  "include_branches": false
}
```

## âš ï¸ å®‰å…¨æé†’

1. **ä¸è¦æäº¤ config.json**
   - `config.json` åŒ…å«æ•æ„Ÿä¿¡æ¯ï¼Œå·²åœ¨ `.gitignore` ä¸­
   - åªæäº¤ `config.example.json`

2. **å®šæœŸæ›´æ¢ Token**
   - å»ºè®® 3-6 ä¸ªæœˆæ›´æ¢ä¸€æ¬¡
   - ä¸ç”¨çš„ token åŠæ—¶åˆ é™¤

3. **Token æƒé™æœ€å°åŒ–**
   - åªç»™å¿…è¦çš„æƒé™ï¼š`api` + `read_repository`

## ğŸ” æ•…éšœæ’æŸ¥

### âŒ é…ç½®æ–‡ä»¶ä¸å­˜åœ¨
```
âŒ é”™è¯¯: é…ç½®æ–‡ä»¶ 'config.json' ä¸å­˜åœ¨ï¼
   è¯·ä» config.example.json å¤åˆ¶å¹¶ä¿®æ”¹é…ç½®
```
**è§£å†³**ï¼š`cp config.example.json config.json`

### âŒ Token æœªé…ç½®
```
âŒ é”™è¯¯: è¯·å…ˆåœ¨ config.json ä¸­é…ç½®ä½ çš„ GitLab Tokenï¼
```
**è§£å†³**ï¼šåœ¨ `config.json` ä¸­å¡«å…¥ä½ çš„ Token

### âŒ è®¤è¯å¤±è´¥
```
âŒ è¯·æ±‚å¤±è´¥: 401 Unauthorized
```
**è§£å†³**ï¼šæ£€æŸ¥ Token æ˜¯å¦æ­£ç¡®ï¼Œæ˜¯å¦å·²è¿‡æœŸ

### âš ï¸ æ²¡æœ‰æ‰¾åˆ°ä»»ä½•æäº¤è®°å½•
```
âš ï¸  æ²¡æœ‰æ‰¾åˆ°ä»»ä½•æäº¤è®°å½•
```
**è§£å†³**ï¼šæ£€æŸ¥ `since_date` å’Œ `until_date` æ˜¯å¦åˆç†

## ğŸ“ ç›®å½•ç»“æ„

```
src/
â”œâ”€â”€ fetch_commits_gitlab.py  # GitLab æäº¤è®°å½•è·å–è„šæœ¬
â”œâ”€â”€ fetch_commits_github.py  # GitHub æäº¤è®°å½•è·å–è„šæœ¬ï¼ˆå¾…åˆ›å»ºï¼‰
â”œâ”€â”€ config.json              # é…ç½®æ–‡ä»¶ï¼ˆä¸æäº¤ï¼‰
â”œâ”€â”€ config.example.json      # é…ç½®ç¤ºä¾‹ï¼ˆæäº¤ï¼‰
â”œâ”€â”€ .gitignore               # Git å¿½ç•¥è§„åˆ™
â””â”€â”€ README.md                # æœ¬æ–‡æ¡£
```

## ğŸ“ é—®é¢˜åé¦ˆ

æœ‰é—®é¢˜ï¼Ÿè¯·è”ç³»ï¼šwangxiaozhuang@example.com
